---
title: How to Create a Blog with Next.js
description: How to build a Next.js blog using MDX with Prism.js
publishedAt: August 19, 2023
tags: ['Next.js', 'Web Development']
previewImage: '/images/blog/nextjs-markdown-blog.jpeg'
---

## Introduction

In this tutorial, we will learn how to create a blog using Next.js and MDX. We will also use [Prism](https://github.com/PrismJS/prism-themes) to style our code blocks.

### Table of Contents

-   [Prerequisites](#prerequisites)
-   [Setting Up Next.js Project](#setting-up-nextjs-project)
-   [Fetching and Displaying Blog Posts](#fetching-and-displaying-blog-posts)
-   [Creating Individual Blog Posts](#creating-individual-blog-posts)
-   [Styling the Blog](#styling-the-blog)
-   [Conclusion](#conclusion)

### Prerequisites

Before we begin, make sure you have Node.js and npm installed on your machine.

-   [Node.js](https://nodejs.org/en/)
-   [npm](https://www.npmjs.com/)

### Setting Up Next.js Project

First, let's set up a new Next.js project.

#### Step 1: Initialize a new Next.js project

Open your terminal and run the following commands:

```bash
npx create-next-app my-blog
cd my-blog

# my-blog is the name of the project
# You can add the --use-yarn or --use-pnp flag if you use Yarn or PnP
# Example: npx create-next-app my-blog --use-yarn
```

#### Step 2: Configure Webpack

In your `next.config.js` file, add the following code:

```js
module.exports = {
    // ...
    webpack: (config, { isServer }) => {
        if (!isServer) {
            config.resolve.fallback = {
                fs: false
            }
        }

        return config
    }
}
```

### Fetching and Displaying Blog Posts

Now, let's create a blog page that displays a list of blog posts.

#### Step 1: Fetch Blog Posts

Create a `mdx.js` file in the `lib` directory to handle MDX content and fetching blog posts:

```jsx
// lib/mdx.js
import { serialize } from 'next-mdx-remote/serialize'
import { join } from 'path'
import rehypeCodeTitles from 'rehype-code-titles'
import rehypePrism from 'rehype-prism-plus'
import matter from 'gray-matter'
import fs from 'fs'

const root = process.cwd()
const postsDir = join(root, 'src', 'posts')

export const getPostBySlug = async slug => {
    const realSlug = slug.replace(/\.mdx$/, '')
    const fullPath = join(postsDir, `${realSlug}.mdx`)
    const fileContents = fs.readFileSync(fullPath, 'utf8')

    const { data, content } = matter(fileContents)
    const mdxSource = await serialize(content, {
        mdxOptions: {
            rehypePlugins: [rehypeCodeTitles, rehypePrism]
        }
    })

    return {
        slug: realSlug,
        meta: data,
        mdxSource
    }
}

export const getAllPosts = async () => {
    const slugs = fs.readdirSync(postsDir)
    const posts = await Promise.all(slugs.map(async slug => await getPostBySlug(slug)))
    return posts
}
```

#### Step 2: Create the Blog Page

Create an `index.js` file in the `pages/blog` directory:

```jsx
// pages/blog/index.js
import { getAllPosts } from '@/lib/mdx'
import Link from 'next/link'

const BlogPage = ({ posts }) => {
    return (
        <div>
            <h1>Blog</h1>
            <ul>
                {posts.map(post => (
                    <li key={post.slug}>
                        <Link href={`/blog/${post.slug}`}>{post.meta.title}</Link>
                    </li>
                ))}
            </ul>
        </div>
    )
}

export default BlogPage

export const getStaticProps = async () => {
    const posts = await getAllPosts()

    return {
        props: {
            posts
        }
    }
}
```

### Creating Individual Blog Posts

In this section, we will create individual blog post pages.

#### Step 1: Create [slug].js

Create a `[slug].js` file in the `pages/blog` directory:

```jsx
// pages/blog/[slug].js
import { MDXRemote } from 'next-mdx-remote'
import { getPostBySlug, getAllPosts } from '@/lib/mdx'

const BlogPost = ({ post }) => {
    return (
        <div>
            <h1>{post.meta.title}</h1>
            <MDXRemote {...post.mdxSource} />
        </div>
    )
}

export default BlogPost

export const getStaticPaths = async () => {
    const posts = await getAllPosts()

    return {
        paths: posts.map(post => ({
            params: {
                slug: post.slug
            }
        })),
        fallback: false
    }
}

export const getStaticProps = async ({ params }) => {
    const post = await getPostBySlug(params.slug)

    return {
        props: {
            post
        }
    }
}
```

### Styling the Blog

In this section, we will style the blog using [Prism](https://github.com/PrismJS/prism-themes).
Create a `prism.css` file in the `styles` and copy the css from [Prism](https://github.com/PrismJS/prism-themes) into it.

### Conclusion

Congratulations! You have successfully created a blog using Next.js and MDX.
